(function(a){a.fn.imageZoom=function(f){if(window.ontouchstart!==undefined){return false}var s,F=new Image(),b=false,h=true,e=false,k,A=0,t=0,r=0,p=0,D=0,y=0,w=0,v=0,j=0,g=0,d=0,c=0,q=0,o=0,z=false,u=0,m=0,B;f=a.extend({},a.fn.imageZoom.defaults,f);return this.each(function(){s=this;var G=s.tagName.toLowerCase();if(G=="img"){var H=a(s).offset();A=H.left;t=H.top;r=a(s).width();p=a(s).height();d=r*f.zoomRatio;c=p*f.zoomRatio;j=A+r+f.zoomAreaOffsetX;g=t+f.zoomAreaOffsetY;q=f.zoomAreaWidth?f.zoomAreaWidth:r;o=f.zoomAreaHeight?f.zoomAreaHeight:p;w=q/f.zoomRatio;v=o/f.zoomRatio;i(s);i("obj_lt: "+A+","+t+"  obj_xy: "+r+","+p+"  zoom_xy: "+d+","+c+"  curObj_xy: "+w+","+v);if(f.largeImageUrl){B=f.largeImageUrl}else{B=a(s).attr("src")}if(typeof window.getSelection!=="function"){B=l(B,"timestamp",(new Date()).getTime())}i(B);F.src=B;F.width=d;F.height=c;a(F).error(function(){h=false;i("image load error")});F.onload=function(){b=true;i("image onload")};a("body").unbind(".imageZoom");a("body").bind("mousemove.imageZoom",function(I){x(I)})}else{i("Object tagname must be img.")}});function i(G){if(f.debugMode&&"console" in window){console.info("jQuery imageZoom: "+G)}}function n(){z=false;e=false;a("#"+f.zoomAreaId).remove();a("#"+f.lensId).remove()}function C(G){if(!h){a("#"+f.zoomAreaId+" div").html(f.errorMessage)}else{if(b){i("image loaded");a("#"+f.zoomAreaId).html("").append(F);clearTimeout(k)}else{k=setTimeout(function(H){C(H)},200)}}}function E(H){e=true;var G='<div id="'+f.zoomAreaId+'" style="position:absolute;overflow:hidden;border:1px solid '+f.zoomAreaBorderColor+";background-color:#fff;left:"+j+"px;top:"+g+"px;width:"+(q-2)+"px;height:"+(o-2)+"px;z-index:"+f.zoomAreaZindex+';"><div style="padding:45% 20%;text-align:center;font-size:'+(q/20)+'px;color:#777;font-weight:bold;">'+f.preloadMessage+"</div></div>";if(f.lens){G+='<div id="'+f.lensId+"\" style=\"position:absolute;overflow:hidden;content:'';cursor:move;filter:progid:DXImageTransform.Microsoft.Alpha(Opacity="+(f.lensOpacity*100)+");opacity:"+f.lensOpacity+";width:"+(w-2)+"px;height:"+(v-2)+"px;border:1px solid "+f.lensBorderColor+";background-color:"+f.lensColor+";z-index:"+f.lensZindex+';"></div>'}a(G).prependTo(f.parent);a(F).css({position:"absolute",top:"0",left:"0",width:d,height:c});C()}function x(G){u=G?G.pageX-A:0;m=G?G.pageY-t:0;if(u<0||m<0||u>r||m>p){z=false;n()}else{z=true;if(!e){E()}fpl=(u-(w/2))<0?0:u-(w/2);fpt=(m-(v/2))<0?0:m-(v/2);fpl=fpl>(r-w)?r-w:fpl;fpt=fpt>(p-v)?p-v:fpt;zxl=fpl/r*d;zyt=fpt/p*c;a("#"+f.zoomAreaId+" img").css({left:zxl*(-1),top:zyt*(-1)});if(f.lens){a("#"+f.lensId).css({left:A+fpl,top:t+fpt})}}}function l(I,G,J){var H=new RegExp("([?|&])"+G+"=.*?(&|$)","i");separator=I.indexOf("?")!==-1?"&":"?";if(I.match(H)){return I.replace(H,"$1"+G+"="+J+"$2")}else{return I+separator+G+"="+J}}};a.imageZoom={};a.imageZoom.destroy=function(){};a.fn.imageZoom.defaults={zoomAreaId:"imageZoom_zoomArea",zoomAreaWidth:false,zoomAreaHeight:false,zoomAreaZindex:100,zoomAreaOffsetX:10,zoomAreaOffsetY:0,zoomAreaBorderColor:"#ccc",lens:true,lensId:"imageZoom_lensArea",lensOpacity:0.3,lensZindex:200,lensColor:"#3695d7",lensBorderColor:"#000",parent:"body",preloadMessage:"Image Loading...",errorMessage:"Error while Loading Image.",largeImageUrl:false,zoomRatio:3,debugMode:false}})(jQuery);